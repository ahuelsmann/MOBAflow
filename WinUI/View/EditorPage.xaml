<Page
    x:Class="Moba.WinUI.View.EditorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:domain="using:Moba.Domain"
    xmlns:local="using:Moba.WinUI.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodel="using:Moba.SharedUI.ViewModel"
    xmlns:converter="using:Moba.WinUI.Converter"
    DataContext="{x:Bind ViewModel}"
    x:Name="PageRoot"
    mc:Ignorable="d">

    <Page.Resources>
        <converter:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converter:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter" />
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Page Header  -->
        <StackPanel Grid.Row="0" Margin="16,2,16,2" Spacing="8">
            <TextBlock FontWeight="Bold" Style="{StaticResource TitleTextBlockStyle}" Text="Editor" />
        </StackPanel>

        <!--  TabView Navigation  -->
        <TabView x:Name="EditorTabView" Grid.Row="1" 
                 TabWidthMode="SizeToContent" 
                 IsAddTabButtonVisible="False" 
                 CanDragTabs="True" 
                 CanReorderTabs="True">
            
            <!--  ============================================  -->
            <!--  ============================================  -->
            <!--  Solution Tab: Projects + PropertyGrid  -->
            <!--  ============================================  -->
            <TabViewItem x:Name="SolutionTab" Header="Solution" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE8F1;" />
                </TabViewItem.IconSource>
                <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MinWidth="300" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="400" MinWidth="300" MaxWidth="600" />
                </Grid.ColumnDefinitions>

                <!--  Column 0: Projects  -->
                <Grid Grid.Column="0" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Projects" />
                    <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.SolutionViewModel.Projects, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedProject, Mode=TwoWay}" SelectionMode="Single">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:ProjectViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE8F1;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="1" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 2: PropertyGrid  -->
                <Grid Grid.Column="2" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Properties" />
                    <local:SimplePropertyGrid Grid.Row="1" SelectedObject="{Binding CurrentSelectedObject, Mode=OneWay}" />
                </Grid>
            </Grid>
            </TabViewItem>

            <!--  ============================================  -->
            <!--  ============================================  -->
            <!--  Journeys Tab: Journeys + Stations + City Library + PropertyGrid  -->
            <!--  ============================================  -->
            <TabViewItem x:Name="JourneysTab" Header="Journeys" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE81D;" />
                </TabViewItem.IconSource>
                <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250" MinWidth="200" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="250" MinWidth="200" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="250" MinWidth="200" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" MinWidth="300" />
                </Grid.ColumnDefinitions>

                <!--  Column 0: Journeys  -->
                <Grid Grid.Column="0" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Journeys" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.CurrentProjectViewModel.Journeys, Mode=OneWay}" 
                              SelectedItem="{x:Bind ViewModel.SelectedJourney, Mode=TwoWay}" 
                              SelectionMode="Single"
                              Tapped="JourneyListView_Tapped">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:JourneyViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE81D;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="1" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 2: Stations (of selected Journey)  -->
                <Grid Grid.Column="2" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Stations" />
                    <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.SelectedJourney.Stations, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedStation, Mode=TwoWay}" SelectionMode="Single" AllowDrop="True" DragOver="StationListView_DragOver" Drop="StationListView_Drop">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:StationViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE80F;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="3" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 4: City Library (for Drag & Drop)  -->
                <Grid Grid.Column="4" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="City Library" />
                    <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.CityLibrary, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedCity, Mode=TwoWay}" SelectionMode="Single" CanDragItems="True" DragItemsStarting="CityListView_DragItemsStarting" DoubleTapped="CityListView_DoubleTapped">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="domain:City">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE80F;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="5" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 6: PropertyGrid  -->
                <Grid Grid.Column="6" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Properties" />
                    <local:SimplePropertyGrid Grid.Row="1" SelectedObject="{Binding CurrentSelectedObject, Mode=OneWay}" />
                </Grid>
            </Grid>
            </TabViewItem>

            <!--  ============================================  -->
            <!--  Workflows Tab: Workflows + Actions + PropertyGrid  -->
            <!--  ============================================  -->
            <TabViewItem x:Name="WorkflowsTab" Header="Workflows" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE713;" />
                </TabViewItem.IconSource>
                <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300" MinWidth="200" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="300" MinWidth="200" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" MinWidth="300" />
                </Grid.ColumnDefinitions>

                <!--  Column 0: Workflows  -->
                <Grid Grid.Column="0" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Workflows" />
                    <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.CurrentProjectViewModel.Workflows, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedWorkflow, Mode=TwoWay}" SelectionMode="Single" CanDragItems="True" DragItemsStarting="WorkflowListView_DragItemsStarting">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:WorkflowViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE713;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="1" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 2: Actions (of selected Workflow)  -->
                <Grid Grid.Column="2" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Actions" />
                    <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.SelectedWorkflow.Actions, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedAction, Mode=TwoWay}" SelectionMode="Single">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE945;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" VerticalAlignment="Center">
                                        <Run Text="{Binding Name}" FontWeight="SemiBold" />
                                        <Run Text=" (" Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        <Run Text="{Binding Type}" Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                        <Run Text=")" Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                                    </TextBlock>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="3" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 4: PropertyGrid  -->
                <Grid Grid.Column="4" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Properties" />
                    <local:SimplePropertyGrid Grid.Row="1" SelectedObject="{Binding CurrentSelectedObject, Mode=OneWay}" />
                </Grid>
            </Grid>
            </TabViewItem>

            <!--  ============================================  -->
            <!--  Trains Tab: Trains + Locomotives + Wagons + Libraries + PropertyGrid  -->
            <!--  ============================================  -->
            <TabViewItem x:Name="TrainsTab" Header="Trains" IsClosable="False">
                <TabViewItem.IconSource>
                    <FontIconSource Glyph="&#xE7C0;" />
                </TabViewItem.IconSource>
                <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200" MinWidth="150" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="200" MinWidth="150" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="200" MinWidth="150" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="180" MinWidth="150" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="180" MinWidth="150" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="180" MinWidth="150" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" MinWidth="300" />
                </Grid.ColumnDefinitions>

                <!--  Column 0: Trains (Master)  -->
                <Grid Grid.Column="0" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Trains" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.CurrentProjectViewModel.Trains, Mode=OneWay}" 
                              SelectedItem="{x:Bind ViewModel.SelectedTrain, Mode=TwoWay}" 
                              SelectionMode="Single">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:TrainViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE7C0;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="1" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 2: Locomotives (of selected Train)  -->
                <Grid Grid.Column="2" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Locomotives" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.SelectedTrain.Locomotives, Mode=OneWay}" 
                              SelectionMode="Single"
                              AllowDrop="True" 
                              DragOver="LocomotiveListView_DragOver" 
                              Drop="LocomotiveListView_Drop"
                              KeyDown="LocomotiveListView_KeyDown">
                        <ListView.ContextFlyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Remove" Icon="Delete" Click="RemoveLocomotiveMenuItem_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="Delete" />
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Duplicate" Icon="Copy" Click="DuplicateLocomotiveMenuItem_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="D" Modifiers="Control" />
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </ListView.ContextFlyout>
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:LocomotiveViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE7C8;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="3" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 4: Wagons (of selected Train)  -->
                <Grid Grid.Column="4" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Wagons" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.SelectedTrain.Wagons, Mode=OneWay}" 
                              SelectionMode="Single"
                              AllowDrop="True" 
                              DragOver="WagonListView_DragOver" 
                              Drop="WagonListView_Drop"
                              KeyDown="TrainWagonListView_KeyDown">
                        <ListView.ContextFlyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Text="Remove" Icon="Delete" Click="RemoveWagonMenuItem_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="Delete" />
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                                <MenuFlyoutItem Text="Duplicate" Icon="Copy" Click="DuplicateWagonMenuItem_Click">
                                    <MenuFlyoutItem.KeyboardAccelerators>
                                        <KeyboardAccelerator Key="D" Modifiers="Control" />
                                    </MenuFlyoutItem.KeyboardAccelerators>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </ListView.ContextFlyout>
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:WagonViewModel">
                                <Grid Padding="6">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="16" Glyph="&#xE7E8;" Margin="0,0,8,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="5" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 6: Locomotive Library (Drag Source)  -->
                <Grid Grid.Column="6" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Loco Library" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.CurrentProjectViewModel.Locomotives, Mode=OneWay}" 
                              SelectionMode="Single"
                              CanDragItems="True" 
                              DragItemsStarting="LocomotiveLibrary_DragItemsStarting"
                              DoubleTapped="LocomotiveLibrary_DoubleTapped">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:LocomotiveViewModel">
                                <Grid Padding="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="14" Glyph="&#xE7C8;" Margin="0,0,6,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" FontSize="12" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="7" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 8: Passenger Wagon Library (Drag Source)  -->
                <Grid Grid.Column="8" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Passenger" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.CurrentProjectViewModel.PassengerWagons, Mode=OneWay}" 
                              SelectionMode="Single"
                              CanDragItems="True" 
                              DragItemsStarting="PassengerWagonListView_DragItemsStarting"
                              DoubleTapped="PassengerWagonLibrary_DoubleTapped">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:PassengerWagonViewModel">
                                <Grid Padding="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="14" Glyph="&#xE7E8;" Margin="0,0,6,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" FontSize="12" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="9" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 10: Goods Wagon Library (Drag Source)  -->
                <Grid Grid.Column="10" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Goods" />
                    <ListView Grid.Row="1" 
                              ItemsSource="{x:Bind ViewModel.CurrentProjectViewModel.GoodsWagons, Mode=OneWay}" 
                              SelectionMode="Single"
                              CanDragItems="True" 
                              DragItemsStarting="GoodsWagonListView_DragItemsStarting"
                              DoubleTapped="GoodsWagonLibrary_DoubleTapped">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodel:GoodsWagonViewModel">
                                <Grid Padding="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <FontIcon Grid.Column="0" FontSize="14" Glyph="&#xE7E8;" Margin="0,0,6,0" />
                                    <TextBlock Grid.Column="1" Text="{x:Bind Name, Mode=OneWay}" VerticalAlignment="Center" FontSize="12" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>

                <Border Grid.Column="11" Width="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

                <!--  Column 12: PropertyGrid  -->
                <Grid Grid.Column="12" Padding="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Padding="16,6,24,4" FontWeight="SemiBold" Style="{StaticResource SubtitleTextBlockStyle}" Text="Properties" />
                    <local:SimplePropertyGrid Grid.Row="1" SelectedObject="{Binding CurrentSelectedObject, Mode=OneWay}" />
                </Grid>
            </Grid>
            </TabViewItem>
        </TabView>
    </Grid>
</Page>













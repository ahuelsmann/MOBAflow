---
description: 'Minimale TODO-Liste fuer MOBAflow'
applyTo: '**'
---

# MOBAflow TODOs

> Letzte Aktualisierung: 2026-01-21

## OFFENE AUFGABEN

### KRITISCH

| Aufgabe | Beschreibung |
|---------|--------------|
| Azure Speech Key | `WinUI/appsettings.json` - Key in Env-Variable verschieben |
| Git History | BFG Repo-Cleaner vor GitHub-Release |

### HOCH

| Aufgabe | Beschreibung |
|---------|--------------|
| SignalBoxPage Refactoring | SignalBoxPage ist rein C#, kein XAML - groesseres Refactoring noetig |
| TrainControlPage3 (ESU-Style) | Alternatives Layout: Runder Drehregler, Funktions-Grid (F0-F7), Lokbild, DCC-Info |
| TrainControlPage4 (Maerklin-Style) | Alternatives Layout: Dual-Cab mit 2 analogen Tachometern, parallele Lok-Steuerung |
| SignalBoxPage3 | Alternatives Layout (Konzept noch zu definieren) |

### MITTEL

| Aufgabe | Beschreibung |
|---------|--------------|
| WorkflowsPage VSM | List + Editor responsive |
| TrainControlPage2 Theme | DynamicResource fuer Theme-Wechsel implementieren |
| SignalBoxPage2 Theme | DynamicResource fuer Theme-Wechsel implementieren |
| Piko A-Gleis PDF | Text aus `99556__A-Gleis_Prospekt_2019.pdf` extrahieren |

## ARCHITEKTUR

- **Auto-Save:** PropertyChanged-basiert fuer alle ViewModels
- **VSM:** Nur Layout (Visibility, ColumnDefinitions), nie Styles
- **Breakpoints:** Compact 0-640px, Medium 641-1199px, Wide 1200px+
- **Themes:** 6 verfuegbar (Modern, Classic, Dark, ESU, Z21, Maerklin)
- **Theme-Resources:** ThemeResourceBuilder erstellt programmatisch ResourceDictionaries
- **NavigationView:** Dynamisch aus NavigationRegistry generiert (nicht mehr XAML hardcoded)

## UI-KONZEPTE (Page-Varianten)

### TrainControl Konzepte
| Page | Konzept | Vorbild | Status |
|------|---------|---------|--------|
| TrainControlPage | Standard WinUI | MOBAflow Original | fertig |
| TrainControlPage2 | Theme/Skin-System | Farbvarianten | fertig |
| TrainControlPage3 | ESU CabControl Style | Runder Drehregler, F-Tasten Grid, Lokbild | geplant |
| TrainControlPage4 | Maerklin CS Style | Dual-Cab, 2 analoge Tachometer | geplant |

### ESU CabControl Style (Page3)
- Runder Drehregler (0-28 Fahrstufen) statt Slider
- Gelber Kreis in Mitte = aktuelle Geschwindigkeit
- Lok-Tabs oben zum schnellen Wechseln
- Lokbild mit Links/Rechts-Navigation
- Funktionstasten-Grid (F0-F7) mit Icons
- DCC-Adresse, Protokoll, RailCom-Status anzeigen
- Blauer Header mit Hamburger-Menu, +/- Buttons

### ESU ECoS Station (Alternative fuer Page3)
- Dual-Cab faehig mit blauem Header
- Lokmenue: Neue Lok, Mehrfachtraktion, Pendelzugstrecke, Bearbeiten, Loeschen
- Lok anlegen Dialog: Datenformat (DCC/Motorola), Adresse, Name, Lokbild-Auswahl
- Fahrbildschirm: Runder Tacho (0-28), F1-F8 seitlich links, Lokbild oben
- SELECT/MULTI Buttons unten

### Maerklin CS Style (Page4)
- Dual-Cab Layout (2 Loks parallel steuern)
- Analoge Tachometer (0-120 km/h) mit Nadelzeiger
- Dunkler Hintergrund, weisse Skala
- Richtungspfeile pro Lok
- Toolbar: keyboard, layout, memory, setup

## ESU FUNKTIONSTASTEN-ICONS (F0-F124)

> Referenz: ESU Uebersicht Funktionstastensymbole (ECoS/CS1R Firmware 4.2.9)
> Zwei Varianten pro Icon: Gelb/gefuellt und Outline/Pixel-Style

### Basis-Funktionen (F0-F14)
| F# | DE | EN |
|----|----|----|
| F0 | Licht | Light |
| F2 | Allgemeine Funktion | Function |
| F3 | Stirnbeleuchtung | Headlight |
| F4 | Innenraumbeleuchtung | Interior lighting |
| F5 | Allgemeines Licht 1 | Universal light 1 |
| F6 | Fahrgeraeusch (Motor) | Drive Sound |
| F7 | Allgemeines Geraeusch | Generic Sound |
| F8 | Bahnhofsdurchsage | Station announcement |
| F9 | Rangiergang | Shunting Speed |
| F10 | ABV (Anfahr/Bremszeit) | Start-Stop-Delay |
| F11 | Automatische Kupplung | Auto coupler (Telex) |
| F12 | Rauchgenerator | Smoke unit |
| F13 | Pantograph | Panto |
| F14 | Fernlicht | Highbeam |

### Sound-Funktionen (F15-F17, F23, F29-F35, F38-F39)
| F# | DE | EN |
|----|----|----|
| F15 | Glocke | Bell |
| F16 | Horn (Hupe) | Horn |
| F17 | Pfeife | Whistle |
| F23 | Bremsenquitschen | Brake sound |
| F29 | Betriebsfunk | Radio sound |
| F30 | Kupplungsgeraeusch | Coupler sound |
| F31 | Schienenstoss | Track sound |
| F34 | Schaffnerpfiff | Thunderer whistle |
| F35 | Pufferstoss | Buffer sound |
| F38 | Kurvengeraeusch | Curve sound |
| F39 | Weichengeraeusch | Turnout sound |
| F65 | Dopplereffekt | Doppler |
| F66 | Kurzpfiff | Whistle (short) |
| F106 | Doppelhorn | DoubleHorn |

### Dampflok-Funktionen
| F# | DE | EN |
|----|----|----|
| F12 | Rauchgenerator | Smoke unit |
| F28 | Dampf ablassen | Steam blow |
| F47 | Luftpumpe | Air pump |
| F48 | Wasserpumpe | Water pump |
| F55 | Feuerbuechse | Firebox |
| F62 | Injektor | Injector |
| F69 | Lichtmaschine | Generator |

### Diesel-Funktionen
| F# | DE | EN |
|----|----|----|
| F32 | Fahrstufe Auf | Notch up |
| F33 | Fahrstufe Ab | Notch down |
| F63 | Hilfsdiesel | Auxiliary diesel |
| F124 | Tanken | Refill Diesel |

### Kran-Funktionen (F24-F27, F95-F99, F114)
| F# | DE | EN |
|----|----|----|
| F24 | Kranarm heben/senken | Crane raise/lower |
| F25 | Kranhaken heben/senken | Crane hook |
| F27 | Kran drehen | Crane turn |
| F95 | Kran links | Crane left |
| F96 | Kran rechts | Crane right |
| F97 | Kran auf | Crane up |
| F98 | Kran ab | Crane down |
| F114 | Kran Magnet | Crane Magnet |

### Beleuchtung erweitert (F50-F61, F78-F88)
| F# | DE | EN |
|----|----|----|
| F50 | Ditchlight | Ditch light |
| F51 | Marslight | Mars light |
| F54 | Rotary Beacon | Rotary beacon |
| F60 | Rangierbeleuchtung | Shunting light |
| F61 | Fuehrerpultbeleuchtung | Board light |
| F78 | Licht hinten | Rear light |
| F79 | Licht vorne | Front light |
| F80 | Fernlicht hinten | Highbeam Rear |
| F81 | Fernlicht vorne | Highbeam Front |
| F84 | Tischbeleuchtung | Table light |
| F86 | Trittstufenbeleuchtung | Step lights |
| F87/88 | Fuehrerstandsbeleuchtung | Cablight |

### Spezial-Funktionen
| F# | DE | EN |
|----|----|----|
| F18 | Tueren auf/zu | Doors |
| F19 | Luefter | Fan |
| F20 | Kohle Schaufeln | Shovel Work |
| F21 | SHIFT (Erweiterung) | Shift |
| F22 | Zugzielanzeige | Plate light |
| F40 | Sicherheitsventil | Relief valve |
| F41 | Oelbrenner | Oil burner |
| F43 | Dynamische Bremse | Dynamic brake |
| F44 | Kompressor | Compressor |
| F46 | Handbremse | Hand brake |
| F59 | Bremse setzen | Set brake |
| F68 | Heizung | Heating |
| F74 | Sifa-Meldung | Sifa-Message |
| F76 | Lastbetrieb | Heavy Load |
| F77 | Leerlaufbetrieb | Coast Operation |
| F89/90 | Pantograph vorne/hinten | Panto Front/Rear |
| F93/94 | Entkuppler vorne/hinten | AutoCoupler |
| F101 | Soundfader/Mute | SoundFader-Mute |

## ABGESCHLOSSEN

| Datum | Aufgabe |
|-------|---------|
| 2026-01-21 | SignalBoxPage2 NullReferenceException Fix - BuildLayout() in Loaded-Event verschoben |
| 2026-01-20 | NavigationView dynamisch aus NavigationRegistry (NavigationItemFactory) |
| 2026-01-20 | PageRegistration erweitert (Category, Order, FeatureToggleKey, BadgeLabelKey, PathIconData, IsBold) |
| 2026-01-20 | MainWindow.xaml ~200 Zeilen XAML entfernt - nur noch Container |
| 2026-01-20 | TrainControlPage2 + SignalBoxPage2 in NavigationView hinzugefuegt (SKIN Badge) |
| 2026-01-20 | String Refactoring geprueft - Domain nutzt korrekt string? fuer optionale Felder |
| 2026-01-20 | ThemeSelectorControl in SettingsPage integriert (Appearance Expander) |
| 2026-01-20 | TrainControlPage2 + SignalBoxPage2 in DI registriert |
| 2026-01-20 | ThemeProvider + ThemeSelectorControl in DI registriert |
| 2026-01-20 | ThemeSelectorControl erweitert (6 Themes in 2 Reihen) |
| 2026-01-20 | ThemeResourceBuilder: ESU/Z21/Maerklin Themes hinzugefuegt |
| 2026-01-20 | ApplicationTheme Enum erweitert (6 Themes) |
| 2026-01-20 | Instruction Files bereinigt (~95% Reduktion) |
| 2026-01-19 | Instruction Files Cleanup |
| 2026-01-18 | TrackPlanEditorPage VSM |
| 2026-01-17 | TrainControlPage VSM |

## THEME-SYSTEM STATUS

| Theme | ResourceBuilder | XAML-Datei | Status |
|-------|-----------------|------------|--------|
| Modern | BuildModernTheme() | ThemeModern.xaml | fertig |
| Classic | BuildClassicTheme() | ThemeClassic.xaml | fertig |
| Dark | BuildDarkTheme() | ThemeDark.xaml | fertig |
| ESU CabControl | BuildEsuCabControlTheme() | ThemeEsuCabControl.xaml | fertig |
| Roco Z21 | BuildRocoZ21Theme() | ThemeRocoZ21.xaml | fertig |
| Maerklin CS | BuildMaerklinCSTheme() | ThemeMaerklinCS.xaml | fertig |

## PDF-EXTRAKTION STATUS

| PDF | Extrahiert | Pfad |
|-----|------------|------|
| ESU CabControl Anleitung | ja | docs/extracted/.../text_content.md |
| Roco Z21 Prospekt | ja | docs/extracted/.../text_content.md |
| Piko A-Gleis 2019 | nein | docs/99556__A-Gleis_Prospekt_2019.pdf |

## REGELN

1. Datei lesen vor Aenderungen
2. Offene Tasks nicht loeschen
3. Erledigte mit Datum markieren

## UI-REFERENZ-BILDER (Session 2026-01-21)

> Diese Bilder wurden im Chat geteilt und analysiert.
> Copilot kann keine Bilder aus PDFs extrahieren - nur direkt geteilte Screenshots.

| Bild | Quelle | Inhalt | Verwendung |
|------|--------|--------|------------|
| ESU CabControl Mobile | PDF Screenshot | Runder Drehregler, Lok-Tabs, F-Tasten Grid | TrainControlPage3 |
| Maerklin CS Dual-Cab | PDF Screenshot | 2x Analog-Tacho (0-120), dunkler Hintergrund | TrainControlPage4 |
| ESU ECoS Station | PDF Screenshot | Lokmenue, Lok-anlegen-Dialog, Fahrbildschirm | TrainControlPage3 Alt |
| ESU Funktionssymbole | PDF Screenshot | ~120 Icons in 2 Varianten (gelb/outline) | Icon-Bibliothek |

